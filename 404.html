<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Redirecting...</title>
  <script>
    // GitHub Pages SPA 路由支持
    // 将所有 404 请求重定向到 index.html，让 Flutter 路由系统处理
    (function() {
      var path = window.location.pathname;
      var search = window.location.search;
      var hash = window.location.hash;
      
      // 防止循环重定向：检查是否已经包含 /index.html
      if (path.indexOf('/index.html') !== -1) {
        // 如果路径已经包含 index.html，说明已经重定向过了
        // 提取原始路径（去掉 /index.html 前缀）
        var originalPath = path.replace(/\/index\.html/g, '');
        if (!originalPath) {
          originalPath = '/';
        }
        
        // 保存原始路径到 sessionStorage，供 Flutter 应用使用
        try {
          sessionStorage.setItem('_404_redirect_path', originalPath + search + hash);
        } catch (e) {
          console.error('Failed to save redirect path:', e);
        }
        
        // 直接重定向到 /index.html，不带任何路径
        window.location.replace('/index.html');
        return;
      }
      
      // 第一次访问：保存原始路径和查询参数
      try {
        var fullPath = path + search + hash;
        sessionStorage.setItem('_404_redirect_path', fullPath);
      } catch (e) {
        console.error('Failed to save redirect path:', e);
      }
      
      // 直接重定向到 /index.html（不带路径，避免循环）
      window.location.replace('/index.html');
    })();
  </script>
  <meta http-equiv="refresh" content="0; url=/index.html">
</head>
<body>
  <p>Redirecting to <a href="/index.html">home page</a>...</p>
</body>
</html>

