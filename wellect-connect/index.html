<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/wellect-connect/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="TRON Wallet Login Module - 可嵌入的钱包登录模块" />
    <title>TRON Wallet Login</title>
    <script type="module" crossorigin src="/wellect-connect/assets/index.CHu2UhUA.js"></script>
    <link rel="modulepreload" crossorigin href="/wellect-connect/assets/buffer-polyfill.ErO7y5re.js">
    <link rel="modulepreload" crossorigin href="/wellect-connect/assets/react-vendor.Bj0G0Oyz.js">
    <link rel="modulepreload" crossorigin href="/wellect-connect/assets/wallet-vendor.CHv2NQr2.js">
    <link rel="stylesheet" crossorigin href="/wellect-connect/assets/wallet-vendor.LO4jQlsU.css">
  </head>
  <body>
    <div id="root"></div>
    <!-- Critical: Set up Buffer BEFORE any modules load -->
    <script>
      console.log('[HTML] Script execution started')
      console.log('[HTML] Before polyfills, Buffer check:', typeof window !== 'undefined' ? typeof window.Buffer : 'window undefined')
      
      // Immediately set up a Buffer placeholder that will be replaced when buffer-polyfill loads
      if (typeof window !== 'undefined') {
        // Store the actual Buffer value in a closure to avoid recursion
        let _bufferValue = null
        let _bufferReady = false
        
        // Create a minimal fallback Buffer implementation with essential methods
        const fallbackBuffer = {
          from: function(data, encoding) {
            if (typeof data === 'string') {
              const bytes = new Uint8Array(data.length)
              for (let i = 0; i < data.length; i++) {
                bytes[i] = data.charCodeAt(i)
              }
              return bytes
            }
            return new Uint8Array(data)
          },
          alloc: function(size, fill, encoding) {
            const buf = new Uint8Array(size)
            if (fill !== undefined) {
              if (typeof fill === 'number') {
                buf.fill(fill)
              } else if (typeof fill === 'string') {
                const fillBytes = this.from(fill, encoding)
                for (let i = 0; i < Math.min(size, fillBytes.length); i++) {
                  buf[i] = fillBytes[i]
                }
              }
            }
            return buf
          },
          allocUnsafe: function(size) {
            return new Uint8Array(size)
          },
          concat: function(list, totalLength) {
            if (!Array.isArray(list)) return new Uint8Array(0)
            const length = totalLength !== undefined ? totalLength : list.reduce((sum, buf) => sum + buf.length, 0)
            const result = new Uint8Array(length)
            let offset = 0
            for (let i = 0; i < list.length; i++) {
              const buf = list[i]
              if (buf && buf.length) {
                result.set(buf, offset)
                offset += buf.length
              }
            }
            return result
          },
          isBuffer: function(obj) {
            return obj instanceof Uint8Array
          }
        }
        
        // Set up a getter that avoids recursion by using closure variable
        Object.defineProperty(window, 'Buffer', {
          get: function() {
            if (_bufferReady && _bufferValue) {
              return _bufferValue
            }
            // Return fallback if Buffer not ready yet
            console.warn('[HTML] Buffer not ready, using fallback')
            return fallbackBuffer
          },
          set: function(value) {
            _bufferValue = value
            _bufferReady = true
            console.log('[HTML] Buffer set:', typeof value)
          },
          configurable: true,
          enumerable: true
        })
        
        // Set initial fallback
        window.Buffer = fallbackBuffer
        window.global = window.global || window
        console.log('[HTML] Buffer proxy set up with fallback')
      }
    </script>
    <!-- Load polyfills first, then main app -->
  </body>
</html>

