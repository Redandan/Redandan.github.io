import{r as g,j as e,c as Te,R as ve}from"./react-vendor.Bj0G0Oyz.js";import"./polyfills.BDlAXuMa.js";import{ab as J,ac as ye,ad as je,ae as be,af as Ee,ag as Ne,ah as ke,ai as Le,aj as We,ak as Se,al as Ae,am as Me,an as Re}from"./wallet-vendor.CHv2NQr2.js";import"./buffer-polyfill.ErO7y5re.js";const Pe=()=>{const t=async n=>{try{const i=`${n}test`;return new Promise(o=>{const s=document.createElement("iframe");s.style.display="none",s.src=i;let h=!1;const l=setTimeout(()=>{h||(h=!0,document.body.removeChild(s),o(!1))},1e3);s.onload=()=>{h||(h=!0,clearTimeout(l),document.body.removeChild(s),o(!0))},s.onerror=()=>{h||(h=!0,clearTimeout(l),document.body.removeChild(s),o(!1))},document.body.appendChild(s)})}catch{return!1}},r=async n=>{try{const i=document.createElement("a");return i.href=n,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),await new Promise(o=>setTimeout(o,300)),!0}catch{return!1}};return g.useEffect(()=>{const n=i=>{i.origin===window.location.origin&&i.data&&i.data.type};return window.addEventListener("message",n),()=>{window.removeEventListener("message",n)}},[]),{checkAppInstalled:t,triggerDeepLink:r}},le=()=>{const[t,r]=g.useState({isPC:!1,isMobile:!1,isIOS:!1,isAndroid:!1,isTablet:!1,isPWA:!1,isStandalone:!1,platform:"",browser:""});return g.useEffect(()=>{const n=()=>{const s=navigator.userAgent||navigator.vendor||window.opera,h=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(s),l=/iPad|iPhone|iPod/.test(s)&&!window.MSStream,f=/Android/.test(s),T=/iPad/.test(s)||f&&!/Mobile/.test(s),p=!h,m=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),x=m;let a="Unknown";s.indexOf("Chrome")>-1&&s.indexOf("Edg")===-1?a="Chrome":s.indexOf("Safari")>-1&&s.indexOf("Chrome")===-1?a="Safari":s.indexOf("Firefox")>-1?a="Firefox":s.indexOf("Edg")>-1?a="Edge":(s.indexOf("Opera")>-1||s.indexOf("OPR")>-1)&&(a="Opera");let d="Web";x?l?d="iOS PWA":f?d="Android PWA":d="PWA":p?d="Web PC":l?d="iOS Web":f&&(d="Android Web"),r({isPC:p,isMobile:h,isIOS:l,isAndroid:f,isTablet:T,isPWA:x,isStandalone:m,platform:d,browser:a})};n();let i;const o=()=>{clearTimeout(i),i=setTimeout(n,300)};return window.addEventListener("resize",o),()=>{i&&clearTimeout(i),window.removeEventListener("resize",o)}},[]),t},ce={apiBaseUrl:"https://agoramarketapi.purrtechllc.com/api"};async function De(t){const r=await fetch(`${ce.apiBaseUrl}/auth/wallet-connect/nonce`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({walletAddress:t})});if(!r.ok)throw new Error("ç²å– nonce å¤±æ•—: "+r.statusText);const n=await r.json();if(n.message&&(!n.nonce||n.nonce==="")&&n.message.includes("Nonce:")){const i=n.message.match(/Nonce:\s*([^\n]+)/);i&&i[1]&&(n.nonce=i[1].trim())}if(n.message&&!n.timestamp&&n.message.includes("Timestamp:")){const i=n.message.match(/Timestamp:\s*([^\n]+)/);if(i&&i[1]){const o=parseInt(i[1].trim());isNaN(o)||(n.timestamp=o)}}if(!n.message||n.message==="")throw new Error("ç²å– nonce å¤±æ•—ï¼šç¼ºå°‘ message å­—æ®µ");if(!n.nonce||n.nonce==="")throw new Error("ç²å– nonce å¤±æ•—ï¼šç¼ºå°‘ nonce å­—æ®µ");return n.timestamp||(n.timestamp=Math.floor(Date.now()/1e3)),n}async function Oe(t,r,n,i="tron"){const o={walletAddress:t,signature:r,nonce:n.nonce,timestamp:n.timestamp};i==="tron"&&(o.chain="TRC20",o.chainType="tron");const s=await fetch(`${ce.apiBaseUrl}/auth/wallet-connect/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!s.ok){const l=await s.json().catch(()=>({message:s.statusText}));throw new Error(l.message||"ç™»éŒ„å¤±æ•—: "+s.statusText)}const h=await s.json();if(!h.token||!h.refreshToken)throw new Error(h.message||"ç™»éŒ„éŸ¿æ‡‰ä¸­ç¼ºå°‘ token");return h}const A={WALLET_CONNECTED:"WALLET_CONNECTED",WALLET_DISCONNECTED:"WALLET_DISCONNECTED",WALLET_ADDRESS:"WALLET_ADDRESS",JWT_REQUEST:"JWT_REQUEST",JWT_RECEIVED:"JWT_RECEIVED",JWT_ERROR:"JWT_ERROR",READY:"READY",ERROR:"ERROR",INIT:"INIT",CLOSE:"CLOSE"},M=(t,r={})=>{const n={source:"tron-wallet-login-module",type:t,data:r,timestamp:Date.now()};window.parent&&window.parent!==window&&window.parent.postMessage(n,"*"),window.flutter_inappwebview&&window.flutter_inappwebview.callHandler("onMessage",n),window.onTronWalletLoginMessage&&window.onTronWalletLoginMessage(n)},Ie=t=>{const r=n=>{n.data&&n.data.source==="flutter-app"&&t(n.data)};return window.addEventListener("message",r),window.flutter_inappwebview&&window.flutter_inappwebview.addEventListener("message",r),()=>{window.removeEventListener("message",r),window.flutter_inappwebview&&window.flutter_inappwebview.removeEventListener("message",r)}},oe=()=>{M(A.READY,{version:"1.0.0",timestamp:Date.now()})},Fe=t=>{M(A.ERROR,{error:t.message||t,stack:t.stack})},_e={common:{connect:"é€£æ¥",disconnect:"æ–·é–‹é€£æ¥",cancel:"å–æ¶ˆ",confirm:"ç¢ºèª",loading:"è¼‰å…¥ä¸­",error:"éŒ¯èª¤",success:"æˆåŠŸ",retry:"é‡è©¦",back:"è¿”å›"},login:{title:"é€£æ¥éŒ¢åŒ…",description:{pc:"è«‹é¸æ“‡éŒ¢åŒ…é€£æ¥æ–¹å¼",mobile:"è«‹é¸æ“‡éŒ¢åŒ…é€²è¡Œé€£æ¥",detected:"æª¢æ¸¬åˆ° {wallets}ï¼Œè«‹é¸æ“‡ç™»å…¥æ–¹å¼"},selectWallet:"é¸æ“‡éŒ¢åŒ…",quickLogin:"å¿«æ·ç™»å…¥",useMobileApp:"ä½¿ç”¨æ‰‹æ©Ÿ APP",mobileAppDesc:"é€šé Deep Link æ‰“é–‹ TronLink APP",or:"æˆ–"},wallet:{connected:"å·²é€£æ¥éŒ¢åŒ…",connectedWaitingSignature:"å·²é€£æ¥éŒ¢åŒ…(ç­‰å¾…ç°½å)",connectedSignatureSuccess:"å·²é€£æ¥éŒ¢åŒ…(ç°½åæˆåŠŸ)",redirectingToLogin:"è·³è½‰ç™»å…¥...",disconnected:"éŒ¢åŒ…å·²æ–·é–‹",connecting:"é€£æ¥ä¸­",address:"éŒ¢åŒ…åœ°å€ï¼š",connectingTo:"æ­£åœ¨é€£æ¥åˆ° {wallet}...",unknown:"æœªçŸ¥éŒ¢åŒ…"},errors:{loginFailed:"ç™»å…¥å¤±æ•—ï¼Œè«‹é‡è©¦",cannotOpenApp:"ç„¡æ³•æ‰“é–‹ TronLink APPï¼Œè«‹ç¢ºèªå·²å®‰è£ä¸¦é‡è©¦",appNotInstalled:`æœªæª¢æ¸¬åˆ° TronLink APPï¼Œæ˜¯å¦å‰å¾€ä¸‹è¼‰ï¼Ÿ

å¦‚æœå·²å®‰è£ï¼Œè«‹é»æ“Šå–æ¶ˆå¾Œé‡è©¦ã€‚`,signatureCanceled:"ç°½åå·²å–æ¶ˆã€‚è«‹åœ¨éŒ¢åŒ…ä¸­ç¢ºèªç°½åä»¥ç¹¼çºŒç™»å…¥ã€‚",signatureFailed:"ç°½åå¤±æ•—ï¼Œè«‹é‡è©¦",jwtFailed:"JWT èªè­‰å¤±æ•—: {error}",connectionFailed:"é€£æ¥å¤±æ•—: {error}",walletNotSupported:"{wallet} ä¸æ”¯æŒç°½ååŠŸèƒ½ã€‚è«‹ä½¿ç”¨æ”¯æŒç°½åçš„éŒ¢åŒ…ï¼ˆå¦‚ TronLinkã€Ledger ç­‰ï¼‰ã€‚",ledgerTimeout:"Ledger ç°½åè¶…æ™‚ã€‚è«‹ç¢ºä¿è¨­å‚™å·²é€£æ¥ä¸¦è§£é–ï¼Œç„¶å¾Œé‡è©¦ã€‚",ledgerNotConnected:"Ledger è¨­å‚™æœªé€£æ¥ã€‚è«‹é€£æ¥è¨­å‚™å¾Œé‡è©¦ã€‚",ledgerConfirm:"è«‹åœ¨ Ledger è¨­å‚™ä¸Šç¢ºèªç°½å...",nonceFailed:"ç²å– nonce å¤±æ•—: {error}",verifyFailed:"ç™»éŒ„å¤±æ•—: {error}",unknownError:"æœªçŸ¥éŒ¯èª¤"},tips:{title:"ğŸ’¡ æç¤ºï¼š",pcWithExtension:["æª¢æ¸¬åˆ° {wallets} æ“´å±•","é»æ“Šä¸Šæ–¹æŒ‰éˆ•é¸æ“‡éŒ¢åŒ…é€²è¡Œé€£æ¥","æ”¯æŒå¤šç¨®éŒ¢åŒ…ï¼šç€è¦½å™¨æ“´å±•ã€ç§»å‹•ç«¯éŒ¢åŒ…ã€ç¡¬ä»¶éŒ¢åŒ…","é¦–æ¬¡ä½¿ç”¨éœ€è¦åœ¨éŒ¢åŒ…ä¸­æˆæ¬Š"],pcWithoutExtension:["æ¨è–¦å®‰è£ TronLinkã€TokenPocket ç­‰ç€è¦½å™¨æ“´å±•","æˆ–ä½¿ç”¨ WalletConnect é€£æ¥ç§»å‹•ç«¯éŒ¢åŒ…","æ”¯æŒ Ledger ç¡¬ä»¶éŒ¢åŒ…","é»æ“Šä¸Šæ–¹æŒ‰éˆ•æŸ¥çœ‹æ‰€æœ‰å¯ç”¨é¸é …"],mobile:["ç§»å‹•ç«¯æ¨è–¦ä½¿ç”¨ WalletConnect é€£æ¥éŒ¢åŒ…","æˆ–é€šé Deep Link æ‰“é–‹ TronLink APP","æ”¯æŒ Trust Walletã€ImToken ç­‰ç§»å‹•ç«¯éŒ¢åŒ…","é»æ“Šä¸Šæ–¹æŒ‰éˆ•æŸ¥çœ‹æ‰€æœ‰å¯ç”¨é¸é …"]},modal:{connectWalletTitle:"é€£æ¥ TRON éŒ¢åŒ…ä»¥ç¹¼çºŒ",detected:"å·²æª¢æ¸¬",notFound:"æœªæ‰¾åˆ°",installed:"å·²å®‰è£",notInstalled:"æœªå®‰è£",loading:"è¼‰å…¥ä¸­",connecting:"é€£æ¥ä¸­",connected:"å·²é€£æ¥",disconnect:"æ–·é–‹é€£æ¥"},environment:{webPC:"Web PC",webMobile:"Web ç§»å‹•ç«¯",iosWeb:"iOS Web",androidWeb:"Android Web",iosPWA:"iOS PWA",androidPWA:"Android PWA",pwa:"PWA"},process:{gettingNonce:"ğŸ“¨ æ­£åœ¨ç²å– nonce...",nonceSuccess:"âœ… Nonce ç²å–æˆåŠŸ",signing:"âœï¸ æ­£åœ¨ç°½åæ¶ˆæ¯...",signatureSuccess:"âœ… ç°½åæˆåŠŸ",verifying:"ğŸ” æ­£åœ¨é©—è­‰ç°½åä¸¦ç™»å…¥...",loginSuccess:"âœ… ç™»å…¥æˆåŠŸï¼Œå·²ç²å– Token",jwtSent:"âœ… JWT Token å·²ç™¼é€çµ¦ Flutter",ledgerDetected:"ğŸ” æª¢æ¸¬åˆ° Ledger ç¡¬ä»¶éŒ¢åŒ…ï¼Œè«‹åœ¨è¨­å‚™ä¸Šç¢ºèªç°½å..."},signing:{pendingTitle:"è«‹å®Œæˆç°½åä»¥å®Œæˆç™»å…¥",pendingDesc:"éŒ¢åŒ…å·²é€£æ¥ï¼Œè«‹åœ¨éŒ¢åŒ…ä¸­ç¢ºèªç°½åè«‹æ±‚",retry:"é‡æ–°ç°½å"}},Be={common:{connect:"Connect",disconnect:"Disconnect",cancel:"Cancel",confirm:"Confirm",loading:"Loading",error:"Error",success:"Success",retry:"Retry",back:"Back"},login:{title:"Connect Wallet",description:{pc:"Please select wallet connection method",mobile:"Please select a wallet to connect",detected:"Detected {wallets}, please select login method"},selectWallet:"Select Wallet",quickLogin:"Quick Login",useMobileApp:"Use Mobile APP",mobileAppDesc:"Open TronLink APP via Deep Link",or:"or"},wallet:{connected:"Wallet Connected",connectedWaitingSignature:"Wallet Connected (Waiting for Signature)",connectedSignatureSuccess:"Wallet Connected (Signature Success)",redirectingToLogin:"Redirecting to Login...",disconnected:"Wallet Disconnected",connecting:"Connecting",address:"Wallet Address:",connectingTo:"Connecting to {wallet}...",unknown:"Unknown Wallet"},errors:{loginFailed:"Login failed, please try again",cannotOpenApp:"Cannot open TronLink APP, please confirm it is installed and try again",appNotInstalled:`TronLink APP not detected, go to download?

If already installed, please click cancel and try again.`,signatureCanceled:"Signature canceled. Please confirm the signature in the wallet to continue login.",signatureFailed:"Signature failed, please try again",jwtFailed:"JWT authentication failed: {error}",connectionFailed:"Connection failed: {error}",walletNotSupported:"{wallet} does not support signature function. Please use a wallet that supports signatures (such as TronLink, Ledger, etc.).",ledgerTimeout:"Ledger signature timeout. Please ensure the device is connected and unlocked, then try again.",ledgerNotConnected:"Ledger device not connected. Please connect the device and try again.",ledgerConfirm:"Please confirm signature on Ledger device...",nonceFailed:"Failed to get nonce: {error}",verifyFailed:"Login failed: {error}",unknownError:"Unknown error"},tips:{title:"ğŸ’¡ Tips:",pcWithExtension:["Detected {wallets} extension","Click the button above to select wallet for connection","Supports multiple wallets: browser extensions, mobile wallets, hardware wallets","First-time use requires authorization in the wallet"],pcWithoutExtension:["Recommended to install TronLink, TokenPocket and other browser extensions","Or use WalletConnect to connect mobile wallets","Supports Ledger hardware wallet","Click the button above to view all available options"],mobile:["Mobile devices recommend using WalletConnect to connect wallets","Or open TronLink APP via Deep Link","Supports Trust Wallet, ImToken and other mobile wallets","Click the button above to view all available options"]},modal:{connectWalletTitle:"Connect a wallet on Tron to continue",detected:"Detected",notFound:"NotFound",installed:"Installed",notInstalled:"NotInstalled",loading:"Loading",connecting:"Connecting",connected:"Connected",disconnect:"Disconnect"},environment:{webPC:"Web PC",webMobile:"Web Mobile",iosWeb:"iOS Web",androidWeb:"Android Web",iosPWA:"iOS PWA",androidPWA:"Android PWA",pwa:"PWA"},process:{gettingNonce:"ğŸ“¨ Getting nonce...",nonceSuccess:"âœ… Nonce obtained successfully",signing:"âœï¸ Signing message...",signatureSuccess:"âœ… Signature successful",verifying:"ğŸ” Verifying signature and logging in...",loginSuccess:"âœ… Login successful, Token obtained",jwtSent:"âœ… JWT Token sent to Flutter",ledgerDetected:"ğŸ” Ledger hardware wallet detected, please confirm signature on device..."},signing:{pendingTitle:"Please complete signature to finish login",pendingDesc:"Wallet connected, please confirm signature request in wallet",retry:"Retry Signature"}},de=g.createContext(),_=()=>{const t=g.useContext(de);if(!t)throw new Error("useLanguage must be used within LanguageProvider");return t},qe=({children:t})=>{const r=()=>{try{return localStorage.getItem("wallet-login-language")==="en"?"en":"zh"}catch{return"zh"}},[n,i]=g.useState(r),o={zh:_e,en:Be},s=(p,m={})=>{const x=p.split(".");let a=o[n];for(const d of x)if(a&&typeof a=="object")a=a[d];else return p;return typeof a=="string"&&Object.keys(m).length>0?a.replace(/\{(\w+)\}/g,(d,u)=>m[u]!==void 0?m[u]:d):Array.isArray(a)&&Object.keys(m).length>0?a.map(d=>typeof d=="string"?d.replace(/\{(\w+)\}/g,(u,c)=>m[c]!==void 0?m[c]:u):d):a||p},h=p=>{(p==="zh"||p==="en")&&(i(p),localStorage.setItem("wallet-login-language",p),window.dispatchEvent(new Event("languageChanged")))},l=()=>n,f=()=>n==="zh",T=()=>n==="en";return e.jsx(de.Provider,{value:{language:n,t:s,changeLanguage:h,getLanguage:l,isZh:f,isEn:T},children:t})},$e=()=>{const[t,r]=g.useState(""),{signMessage:n,wallet:i}=J(),{t:o}=_(),s=g.useMemo(()=>!1,[]),h=g.useCallback(async l=>{var f,T;try{r(""),s&&console.log(o("process.gettingNonce"));const p=await De(l);if(s&&console.log(o("process.nonceSuccess"),p.nonce),!n){const x=((f=i==null?void 0:i.adapter)==null?void 0:f.name)||o("wallet.unknown");throw new Error(o("errors.walletNotSupported",{wallet:x}))}const m=((T=i==null?void 0:i.adapter)==null?void 0:T.name)==="Ledger";m?(s&&console.log(o("process.ledgerDetected")),r(o("errors.ledgerConfirm"))):s&&console.log(o("process.signing"));try{const x=await n(p.message);s&&console.log(o("process.signatureSuccess")),m&&r(""),s&&console.log(o("process.verifying"));const a=await Oe(l,x,p,"tron");s&&console.log(o("process.loginSuccess")),M(A.JWT_RECEIVED,{token:a.token,refreshToken:a.refreshToken,user:a.user,address:l,timestamp:Date.now()}),s&&console.log(o("process.jwtSent"))}catch(x){const a=x.message||x.toString();if(a.includes("rejected")||a.includes("denied")||a.includes("cancel")||a.includes("å–æ¶ˆ")||a.includes("æ‹’çµ•"))throw new Error(o("errors.signatureCanceled"));if(m){if(a.includes("timeout")||a.includes("è¶…æ™‚"))throw new Error(o("errors.ledgerTimeout"));if(a.includes("not connected")||a.includes("æœªé€£æ¥"))throw new Error(o("errors.ledgerNotConnected"))}throw x}}catch(p){throw Fe(p),r(o("errors.jwtFailed",{error:p.message||p.toString()})),p}},[n,i,o,s]);return{error:t,setError:r,handleJWTRequest:h}},Ue={TronLink:"TronLink",TokenPocket:"TokenPocket",BitKeep:"BitKeep",OkxWallet:"OKX Wallet",Ledger:"Ledger",WalletConnect:"WalletConnect",Trust:"Trust Wallet",ImToken:"imToken"},ze=t=>Ue[t]||t,Ve=()=>{const{wallets:t,select:r,connect:n,connecting:i,connected:o,wallet:s}=J(),h=!1,l=g.useMemo(()=>{if(!t||t.length===0)return[];const T=["Installed","Loadable","Found","Loading"];let p=t.filter(m=>m.adapter.name==="WalletConnect"?!1:T.includes(m.adapter.readyState)).map(m=>({...m,detectedName:ze(m.adapter.name)}));if(p.length>0){const m=p.map(x=>x.state).filter(x=>x!=null);if(m.length>0){const x=m.every(a=>a==="Loading");x&&p.length>1?(p.length,p=p.filter(a=>a.state!=="Loading")):x||(p.length,p=p.filter(a=>a.state!=="Loading"))}}return p},[t]);return g.useRef(0),g.useEffect(()=>{},[l,h]),{availableWallets:l,handleQuickConnect:async T=>{const p=T.adapter.name;try{if(!t.find(x=>x.adapter.name===p))throw new Error(`æ‰¾ä¸åˆ°éŒ¢åŒ…é©é…å™¨: ${p}`);await r(p),await new Promise(x=>setTimeout(x,500)),await n()}catch(m){const x=(m==null?void 0:m.message)||(m==null?void 0:m.toString())||"";if(x.includes("No wallet is selected")||x.includes("not selected"))try{await r(p),await new Promise(a=>setTimeout(a,800)),await n()}catch(a){const d=(a==null?void 0:a.message)||(a==null?void 0:a.toString())||"";throw d.includes("No wallet is selected")||d.includes("not selected")?new Error(`ç„¡æ³•é¸æ“‡éŒ¢åŒ… ${p}ã€‚è«‹ç¢ºä¿æ“´å±•å·²å®‰è£ä¸¦å•Ÿç”¨ã€‚`):a}else throw m}},connecting:i,connected:o,currentWallet:s}};function B(){try{return localStorage.getItem("wallet-login-language")==="en"?"en":"zh"}catch{return"zh"}}const He={"Connect a wallet on Tron to continue.":"é€£æ¥ TRON éŒ¢åŒ…ä»¥ç¹¼çºŒ","Connect a wallet on Tron to continue":"é€£æ¥ TRON éŒ¢åŒ…ä»¥ç¹¼çºŒ","Connect a wallet on":"é€£æ¥ TRON éŒ¢åŒ…ä»¥ç¹¼çºŒ","Tron to continue":"é€£æ¥ TRON éŒ¢åŒ…ä»¥ç¹¼çºŒ","Connect a wallet":"é€£æ¥éŒ¢åŒ…",Detected:"å·²æª¢æ¸¬",NotFound:"æœªæ‰¾åˆ°",NotDetected:"æœªæª¢æ¸¬",Installed:"å·²å®‰è£",NotInstalled:"æœªå®‰è£",Loading:"è¼‰å…¥ä¸­",Connecting:"é€£æ¥ä¸­",Connected:"å·²é€£æ¥",Disconnect:"æ–·é–‹é€£æ¥","Select Wallet":"é¸æ“‡éŒ¢åŒ…",Wallet:"éŒ¢åŒ…","on Tron":"TRON","to continue":"ä»¥ç¹¼çºŒ"},Je={"Connect a wallet on Tron to continue.":"Connect a wallet on Tron to continue.","Connect a wallet on Tron to continue":"Connect a wallet on Tron to continue","Connect a wallet on":"Connect a wallet on","Tron to continue":"Tron to continue","Connect a wallet":"Connect a wallet",Detected:"Detected",NotFound:"NotFound",NotDetected:"NotDetected",Installed:"Installed",NotInstalled:"NotInstalled",Loading:"Loading",Connecting:"Connecting",Connected:"Connected",Disconnect:"Disconnect","Select Wallet":"Select Wallet",Wallet:"Wallet","on Tron":"on Tron","to continue":"to continue"};function ue(){return B()==="zh"?He:Je}function se(t){if(!t)return t;const r=ue();B()==="zh"&&(t=t.replace(/Connect a wallet on Tron to continue\.?/gi,r["Connect a wallet on Tron to continue"]),t=t.replace(/Connect a wallet on\s*$/gi,r["Connect a wallet on Tron to continue"]),t.includes(r["Connect a wallet on Tron to continue"])?t=t.replace(/Tron to continue\.?/gi,""):t=t.replace(/Tron to continue\.?/gi,""));for(const[i,o]of Object.entries(r)){if(t.trim()===i)return o;const s=new RegExp(`^\\s*${i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\s*$`,"gi");t=t.replace(s,o)}return t}function ge(t){if(t){if(t.nodeType===Node.TEXT_NODE){const r=t.textContent,n=se(r);n!==r&&(t.textContent=n)}else if(t.nodeType===Node.ELEMENT_NODE){if(t.dataset.stateReplaced==="true")return;const r=t.textContent&&(t.textContent.includes("Connect a wallet")||t.textContent.includes("Detected")||t.textContent.includes("NotFound")||t.textContent.includes("Select Wallet"));if(t.dataset.translated==="true"&&!r)return;const n=t.textContent.trim(),o=ue()["Connect a wallet on Tron to continue"];if(n.includes("Connect a wallet on Tron to continue")||n.includes("Connect a wallet on")&&n.includes("Tron to continue")){t.innerHTML=o,t.dataset.translated="true";return}if(t.children.length===0){const s=t.textContent.trim(),h=se(s);if(h!==s){t.textContent=h,t.dataset.translated="true";return}}Array.from(t.childNodes).forEach(s=>{ge(s)})}}}function Ke(t){if(!t)return!1;if(t.textContent.trim().includes("Connect a wallet on Tron to continue"))return t.innerHTML="é€£æ¥ TRON éŒ¢åŒ…ä»¥ç¹¼çºŒ",t.dataset.translated="true",!0;const n=Array.from(t.childNodes);let i=!1,o=!1,s=null,h=null;return n.forEach(l=>{const f=l.textContent.trim();(f.includes("Connect a wallet on")||f==="Connect a wallet on")&&(i=!0,s=l),(f.includes("Tron to continue")||f==="Tron to continue")&&(o=!0,h=l)}),i&&o?(s&&(s.textContent="é€£æ¥ TRON éŒ¢åŒ…ä»¥ç¹¼çºŒ",s.dataset.translated="true"),h&&(h.textContent=""),t.dataset.translated="true",!0):(n.forEach(l=>{if(l.nodeType===Node.TEXT_NODE){const f=l.textContent.trim();if(f==="Connect a wallet on"||f.includes("Connect a wallet on"))l.textContent="é€£æ¥ TRON éŒ¢åŒ…ä»¥ç¹¼çºŒ";else if(f==="Tron to continue"||f.includes("Tron to continue")){const T=l.previousSibling;T&&T.textContent&&T.textContent.includes("é€£æ¥ TRON éŒ¢åŒ…ä»¥ç¹¼çºŒ"),l.textContent=""}}else if(l.nodeType===Node.ELEMENT_NODE){const f=l.textContent.trim();f==="Connect a wallet on"||f.includes("Connect a wallet on")?(l.textContent="é€£æ¥ TRON éŒ¢åŒ…ä»¥ç¹¼çºŒ",l.dataset.translated="true"):(f==="Tron to continue"||f.includes("Tron to continue"))&&(l.textContent="")}}),!1)}function W(){var n,i;const t=['[role="dialog"][class*="wallet"]','[role="dialog"][class*="modal"]','[class*="wallet-adapter"][class*="modal"]','[class*="WalletModal"]'];for(const o of t)try{const s=document.querySelector(o);if(s)return s}catch{}const r=['[role="dialog"]','[class*="wallet-modal"]','[class*="modal"]'];for(const o of r)try{const s=document.querySelector(o);if(s&&((n=s.textContent)!=null&&n.includes("Connect a wallet")||(i=s.textContent)!=null&&i.includes("Select Wallet")))return s}catch{}return null}function he(t,r){if(!t||!r||Object.keys(r).length===0)return;const n=t.querySelectorAll('.adapter-wallet-item, [class*="wallet-item"]');(n.length>0?Array.from(n).map(o=>o.querySelector("button")).filter(Boolean):Array.from(t.querySelectorAll("button")).filter(o=>{var s,h;return o.querySelector(".status-text")||((s=o.textContent)==null?void 0:s.includes("Detected"))||((h=o.textContent)==null?void 0:h.includes("NotFound"))})).forEach(o=>{var f,T;const s=o.querySelector(".status-text");if(!s)return;const h=(f=s.textContent)==null?void 0:f.trim();if((h==="Detected"||h==="å·²æª¢æ¸¬")&&!s.dataset.stateReplaced){let m=(o.textContent||"").replace(/Detected|å·²æª¢æ¸¬|NotFound|æœªæ‰¾åˆ°|Loading|è¼‰å…¥ä¸­|Disconnected|æœªé€£æ¥|Connected|å·²é€£æ¥/gi,"").trim();if(!m||m.length===0){const x=[],a=document.createTreeWalker(o,NodeFilter.SHOW_TEXT,{acceptNode:u=>u.parentElement===s?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT});let d;for(;d=a.nextNode();){const u=(T=d.textContent)==null?void 0:T.trim();u&&u.length>0&&x.push(u)}x.length>0&&(m=x.join(" ").trim())}if(m){let x=r[m];if(!x){for(const[a,d]of Object.entries(r))if(m===a||m.includes(a)||a.includes(m)){x=d;break}if(!x){const a=m.replace(/\s+/g,"").toLowerCase();for(const[d,u]of Object.entries(r)){const c=d.replace(/\s+/g,"").toLowerCase();if(a===c||a.includes(c)||c.includes(a)){x=u;break}}}}if(x){const a=B()==="zh",u={Loading:a?"è¼‰å…¥ä¸­":"Loading",NotFound:a?"æœªæ‰¾åˆ°":"NotFound",Disconnected:a?"æœªé€£æ¥":"Disconnected",Connected:a?"å·²é€£æ¥":"Connected"}[x]||x;s.textContent=u,s.dataset.stateReplaced="true",s.dataset.originalState=x}}}})}function Qe(t=null){const r=W();return r?(t&&he(r,t),r.textContent&&(r.textContent.includes("Connect a wallet")||r.textContent.includes("Detected")||r.textContent.includes("NotFound")||r.textContent.includes("Select Wallet")||r.textContent.includes("NotDetected")||r.textContent.includes("NotInstalled"))&&(r.dataset.translated="false",r.querySelectorAll('[data-translated="true"]').forEach(i=>{i.dataset.stateReplaced||(i.dataset.translated="false")})),!r.dataset.translated||r.dataset.translated==="false"?(r.querySelectorAll('h1, h2, h3, h4, h5, h6, [class*="title"], [class*="Title"]').forEach(o=>{(!o.dataset.translated||o.dataset.translated==="false")&&Ke(o)}),ge(r),r.dataset.translated="true",!0):!1):!1}function Ge(t=null,r=null,n=null){t||B();let i=null,o=null,s=null,h=n||null;const l=()=>W()?(Qe(h),!0):!1,f=d=>{h=d;const u=W();u&&he(u,h)};let T=!1;const p=()=>{T||(T=!0,i&&i.disconnect(),s=W(),s?(i=new MutationObserver(d=>{let u=!1;d.forEach(c=>{c.addedNodes.forEach(C=>{var b;if(C.nodeType===Node.ELEMENT_NODE){const y=((b=C.classList)==null?void 0:b.toString())||"",j=C.getAttribute("role")||"";(y.includes("wallet")||y.includes("modal")||j==="dialog"||C.querySelector('[role="dialog"]')||C.querySelector('[class*="wallet"]')||C.querySelector('[class*="modal"]'))&&(u=!0)}})}),u&&requestAnimationFrame(()=>{l()})}),i.observe(s,{childList:!0,subtree:!0,characterData:!0})):(i=new MutationObserver(d=>{let u=!1,c=!1;d.forEach(C=>{C.addedNodes.forEach(b=>{var y;if(b.nodeType===Node.ELEMENT_NODE){const j=((y=b.classList)==null?void 0:y.toString())||"";((b.getAttribute("role")||"")==="dialog"||j.includes("wallet")||j.includes("modal")||b.querySelector('[role="dialog"]'))&&(u=!0,c=!0)}})}),u&&requestAnimationFrame(()=>{l()}),c&&setTimeout(()=>{T=!1,p()},100)}),document.body&&i.observe(document.body,{childList:!0,subtree:!0})),T=!1)},m=()=>{if(o&&clearInterval(o),r===!1)return;(W()||r===!0)&&(o=setInterval(()=>{W()?l():r===!1&&(clearInterval(o),o=null)},500))};p(),m();const x=()=>{l()};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",x):x();const a=()=>{const d=W();d&&(d.dataset.translated="false",d.querySelectorAll('[data-translated="true"]').forEach(u=>{u.dataset.translated="false"}),l())};return window.addEventListener("storage",a),window.addEventListener("languageChanged",a),{disconnect:()=>{i&&i.disconnect(),o&&clearInterval(o),window.removeEventListener("storage",a),window.removeEventListener("languageChanged",a)},translate:()=>{l()},setModalVisible:d=>{r=d,m(),d&&(p(),requestAnimationFrame(()=>{l()}))},updateWalletStateMap:f}}const F={TRONWALLET_SCHEME:"tronlink://",TRONWALLET_UNIVERSAL_LINK:"https://www.tronlink.org/",CALLBACK_PATH:"/callback"},H={PROJECT_ID:"7412eb629501759c091220ccc09ded23",NETWORK:"mainnet",get METADATA(){return{name:"TRON éŒ¢åŒ…ç™»å…¥æ¨¡å¡Š",description:"TRON éŒ¢åŒ…ç™»å…¥æ¨¡å¡Š - Flutter Web é›†æˆ",url:window.location.origin,icons:[`${window.location.origin}/favicon.ico`]}}},fe=g.createContext(),Xe=()=>{const t=g.useContext(fe);if(!t)throw new Error("useTheme must be used within ThemeProvider");return t},Ze=({children:t})=>{const r=()=>{try{const s=localStorage.getItem("wallet-login-theme");return s?s==="dark"?"dark":"light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}catch{return"light"}},[n,i]=g.useState(r),o=()=>{const s=n==="light"?"dark":"light";i(s),localStorage.setItem("wallet-login-theme",s),document.documentElement.setAttribute("data-theme",s)};return g.useEffect(()=>{document.documentElement.setAttribute("data-theme",n)},[n]),g.useEffect(()=>{const s=window.matchMedia("(prefers-color-scheme: dark)"),h=l=>{localStorage.getItem("wallet-login-theme")||i(l.matches?"dark":"light")};return s.addEventListener("change",h),()=>s.removeEventListener("change",h)},[]),e.jsx(fe.Provider,{value:{theme:n,toggleTheme:o,isDark:n==="dark",isLight:n==="light"},children:t})},re=()=>{const{language:t,changeLanguage:r}=_(),{theme:n,toggleTheme:i}=Xe();return e.jsxs("div",{className:"language-switcher",children:[e.jsx("button",{className:"theme-btn",onClick:i,title:n==="light"?"åˆ‡æ›åˆ°æ·±è‰²ä¸»é¡Œ":"åˆ‡æ›åˆ°æ·ºè‰²ä¸»é¡Œ","aria-label":n==="light"?"Switch to dark theme":"Switch to light theme",children:n==="light"?e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),e.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),e.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),e.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),e.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),e.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),e.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),e.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]})}),e.jsx("button",{className:`lang-btn ${t==="zh"?"active":""}`,onClick:()=>r("zh"),title:"ä¸­æ–‡",children:"ä¸­æ–‡"}),e.jsx("button",{className:`lang-btn ${t==="en"?"active":""}`,onClick:()=>r("en"),title:"English",children:"EN"})]})},Ye=({address:t,signingStatus:r})=>{const{t:n}=_(),{platform:i,browser:o,isPWA:s}=le(),l=r==="pending"?{title:n("wallet.connectedWaitingSignature","å·²é€£æ¥éŒ¢åŒ…(ç­‰å¾…ç°½å)"),icon:e.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"})}),className:"status-waiting"}:r==="success"?{title:n("wallet.connectedSignatureSuccess","å·²é€£æ¥éŒ¢åŒ…(ç°½åæˆåŠŸ)"),icon:e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),className:"status-success"}:{title:n("wallet.connected","å·²é€£æ¥éŒ¢åŒ…"),icon:e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),className:"status-default"};return e.jsxs("div",{className:"wallet-info",children:[e.jsxs("div",{className:`success-message ${l.className}`,children:[e.jsx("div",{className:"status-icon-wrapper",children:l.icon}),e.jsx("h2",{children:l.title}),r==="success"&&e.jsx("p",{className:"login-redirect-message",children:n("wallet.redirectingToLogin","è·³è½‰ç™»å…¥...")})]}),e.jsx("div",{className:"environment-info",children:e.jsxs("div",{className:"env-badge",children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),e.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),e.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]}),e.jsx("span",{className:"env-platform",children:i}),o&&o!=="Unknown"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"env-separator",children:"Â·"}),e.jsx("span",{className:"env-browser",children:o})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"env-separator",children:"Â·"}),e.jsx("span",{className:"env-pwa-badge",children:"PWA"})]})]})}),e.jsxs("div",{className:"address-display",children:[e.jsxs("label",{children:[n("wallet.address"),"ï¼š"]}),e.jsx("div",{className:"address-value",children:t})]}),e.jsx("div",{className:"wallet-actions",children:e.jsx(ye,{})})]})},et=({availableWallets:t,onWalletClick:r,connecting:n,connectedWallet:i})=>t.length===0?null:e.jsx("div",{className:"quick-login-section",children:e.jsx("div",{className:"quick-login-buttons",children:t.map(o=>{var l,f;const s=o.adapter.name===((l=i==null?void 0:i.adapter)==null?void 0:l.name),h=n&&s;return e.jsxs("button",{className:"quick-login-btn",onClick:()=>r(o),disabled:h,children:[e.jsxs("div",{className:"quick-login-icon",children:[o.adapter.icon&&e.jsx("img",{src:o.adapter.icon,alt:o.detectedName,onError:T=>{T.target.style.display="none"}}),(!o.adapter.icon||!o.adapter.icon.startsWith("data:"))&&e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})]}),e.jsx("span",{className:"quick-login-name",children:o.detectedName}),n&&o.adapter.name===((f=i==null?void 0:i.adapter)==null?void 0:f.name)&&e.jsx("div",{className:"quick-login-spinner"})]},o.adapter.name)})})}),tt=500,nt=()=>{const[t,r]=g.useState([]),[n,i]=g.useState(!0),o=g.useRef(null),s=g.useRef(null),h=g.useRef(null),l=g.useRef(n),f=g.useRef(null);g.useEffect(()=>{l.current=n},[n]);const T=g.useCallback((d,u,c=null)=>{if(l.current)try{const C=new Date().toLocaleTimeString("zh-TW",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3}),b={id:Date.now()+Math.random(),timestamp:C,level:d,message:u,data:c?JSON.stringify(c,null,2):null};r(y=>[...y,b].slice(-tt))}catch(C){s.current&&s.current("Logger error:",C)}},[]);g.useEffect(()=>{f.current=T},[T]),g.useEffect(()=>l.current?(o.current||(o.current=console.log.bind(console),s.current=console.error.bind(console),h.current=console.warn.bind(console)),console.log=(...u)=>{try{if(o.current(...u),l.current&&f.current){let c="",C=null;for(const j of u)if(typeof j=="string"){c=j;break}!c&&u.length>0&&(c=String(u[0]));for(const j of u)if(typeof j=="object"&&j!==null&&!Array.isArray(j)&&!(j instanceof Date)){C=j;break}["[useEnvironment]","[useQuickLogin]","[TronWalletLogin]","[QuickLogin]","[Flutter Bridge]"].some(j=>c.includes(j))&&setTimeout(()=>{f.current&&l.current&&f.current("log",c,C)},0)}}catch{o.current&&o.current(...u)}},l.current&&setTimeout(()=>{f.current&&f.current("info","[Logger] æ—¥èªŒç³»çµ±å·²åˆå§‹åŒ–ï¼Œé–‹å§‹æ•ç²æ—¥èªŒ")},50),console.error=(...u)=>{var c;try{if(s.current(...u),!l.current||!f.current)return;const C=u.find(y=>typeof y=="string")||((c=u[0])==null?void 0:c.toString())||"Error",b=u.find(y=>typeof y=="object"&&y!==null&&!Array.isArray(y))||null;setTimeout(()=>{f.current&&f.current("error",C,b)},0)}catch{s.current&&s.current(...u)}},console.warn=(...u)=>{var c;try{if(h.current(...u),!l.current||!f.current)return;const C=u.find(y=>typeof y=="string")||((c=u[0])==null?void 0:c.toString())||"Warning",b=u.find(y=>typeof y=="object"&&y!==null&&!Array.isArray(y))||null;setTimeout(()=>{f.current&&f.current("warn",C,b)},0)}catch{h.current&&h.current(...u)}},()=>{o.current&&(console.log=o.current,console.error=s.current,console.warn=h.current)}):void 0,[]);const p=g.useCallback(()=>{r([])},[]),m=g.useCallback(()=>t.map(d=>{const u=d.data?`
${d.data}`:"";return`[${d.timestamp}] [${d.level.toUpperCase()}] ${d.message}${u}`}).join(`

`),[t]),x=g.useCallback(async()=>{if(t.length===0)throw T("warn","æ²’æœ‰æ—¥èªŒå¯è¤‡è£½"),new Error("æ²’æœ‰æ—¥èªŒå¯è¤‡è£½");const d=m();try{await navigator.clipboard.writeText(d),T("info",`å·²è¤‡è£½ ${t.length} æ¢æ—¥èªŒåˆ°å‰ªè²¼æ¿`)}catch(u){try{const c=document.createElement("textarea");c.value=d,c.style.position="fixed",c.style.left="-999999px",document.body.appendChild(c),c.focus(),c.select();const C=document.execCommand("copy");if(document.body.removeChild(c),C)T("info",`å·²è¤‡è£½ ${t.length} æ¢æ—¥èªŒåˆ°å‰ªè²¼æ¿`);else{const b="è¤‡è£½æ—¥èªŒå¤±æ•—: ç€è¦½å™¨ä¸æ”¯æŒè¤‡è£½åŠŸèƒ½";throw T("error",b),new Error(b)}}catch(c){const C="è¤‡è£½æ—¥èªŒå¤±æ•—: "+(u.message||c.message);throw T("error",C),new Error(C)}}},[t,T,m]),a=g.useCallback(()=>{if(t.length===0){T("warn","æ²’æœ‰æ—¥èªŒå¯å°å‡º");return}const d=m(),u=new Blob([d],{type:"text/plain"}),c=URL.createObjectURL(u),C=document.createElement("a");C.href=c,C.download=`tronwallet-logs-${new Date().toISOString().replace(/[:.]/g,"-")}.txt`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(c),T("info","æ—¥èªŒå·²å°å‡º")},[t,T,m]);return{logs:t,isEnabled:n,setIsEnabled:i,clearLogs:p,copyLogs:x,exportLogs:a,addLog:T}},me=g.createContext(null),ot=({children:t})=>{const r=nt();return e.jsx(me.Provider,{value:r,children:t})},st=()=>g.useContext(me),ie=()=>{const t=st();if(!t)return null;const{logs:r,isEnabled:n,setIsEnabled:i,clearLogs:o,copyLogs:s,exportLogs:h}=t,[l,f]=g.useState(!1),[T,p]=g.useState(!0),[m,x]=g.useState(!1),a=g.useRef(null),d=c=>{switch(c){case"error":return"log-entry-error";case"warn":return"log-entry-warn";case"info":return"log-entry-info";default:return"log-entry-log"}},u=()=>{a.current&&T&&(a.current.scrollTop=a.current.scrollHeight)};return g.useEffect(()=>{l&&T&&setTimeout(u,100)},[r,l,T]),n?e.jsxs("div",{className:`logger-panel ${l?"expanded":"collapsed"}`,children:[e.jsxs("div",{className:"logger-header",children:[e.jsxs("div",{className:"logger-header-left",children:[e.jsx("button",{className:"logger-toggle-btn",onClick:()=>f(!l),title:l?"æ”¶èµ·æ—¥èªŒ":"å±•é–‹æ—¥èªŒ",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l?e.jsx("path",{d:"M18 15l-6-6-6 6"}):e.jsx("path",{d:"M6 9l6 6 6-6"})})}),e.jsxs("span",{className:"logger-title",children:["èª¿è©¦æ—¥èªŒ (",r.length,")"]})]}),l&&e.jsxs("div",{className:"logger-actions",children:[e.jsxs("label",{className:"logger-checkbox",children:[e.jsx("input",{type:"checkbox",checked:T,onChange:c=>p(c.target.checked)}),e.jsx("span",{children:"è‡ªå‹•æ»¾å‹•"})]}),e.jsx("button",{className:"logger-action-btn",onClick:o,title:"æ¸…é™¤æ—¥èªŒ",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})}),e.jsx("button",{className:`logger-action-btn ${m?"copy-success":""}`,onClick:async()=>{try{await s(),x(!0),setTimeout(()=>x(!1),2e3)}catch{}},title:"è¤‡è£½æ—¥èªŒ",children:m?e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}):e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})}),e.jsx("button",{className:"logger-action-btn",onClick:h,title:"å°å‡ºæ—¥èªŒ",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}),e.jsx("button",{className:"logger-action-btn",onClick:()=>i(!1),title:"é—œé–‰æ—¥èªŒ",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]}),l&&e.jsx("div",{className:"logger-content",ref:a,children:r.length===0?e.jsxs("div",{className:"logger-empty",children:[e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",opacity:"0.3",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),e.jsx("polyline",{points:"10 9 9 9 8 9"})]}),e.jsx("p",{children:"æš«ç„¡æ—¥èªŒ"})]}):e.jsx("div",{className:"logger-entries",children:r.map(c=>e.jsxs("div",{className:`log-entry ${d(c.level)}`,children:[e.jsxs("div",{className:"log-entry-header",children:[e.jsx("span",{className:"log-timestamp",children:c.timestamp}),e.jsx("span",{className:`log-level log-level-${c.level}`,children:c.level.toUpperCase()})]}),e.jsx("div",{className:"log-message",children:c.message}),c.data&&e.jsxs("details",{className:"log-data",children:[e.jsx("summary",{children:"æŸ¥çœ‹æ•¸æ“š"}),e.jsx("pre",{children:c.data})]})]},c.id))})})]}):e.jsx("button",{className:"logger-toggle-btn",onClick:()=>i(!0),title:"å•Ÿç”¨æ—¥èªŒ",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),e.jsx("polyline",{points:"10 9 9 9 8 9"})]})})},ae=t=>{const r=(t==null?void 0:t.message)||(t==null?void 0:t.toString())||"";return r.includes("å–æ¶ˆ")||r.includes("rejected")||r.includes("cancel")||r.includes("denied")||r.includes("æ‹’çµ•")},rt=()=>{var ee,te;const{t,language:r}=_(),{address:n,connected:i,wallet:o,connect:s,wallets:h}=J(),{setVisible:l,visible:f}=je(),{triggerDeepLink:T,checkAppInstalled:p}=Pe(),m=le(),{error:x,setError:a,handleJWTRequest:d}=$e(),[u,c]=g.useState(null),{availableWallets:C,handleQuickConnect:b,connecting:y,currentWallet:j}=Ve(),R=g.useMemo(()=>{if(!h||h.length===0)return{};const w={};return h.forEach(v=>{var E;(E=v==null?void 0:v.adapter)!=null&&E.name&&(v!=null&&v.state)&&(w[v.adapter.name]=v.state)}),w},[h]),{isPC:q,isMobile:P,platform:pe,browser:$,isPWA:U}=m,z=C.length>0,xe=(q||U&&!P)&&z,we=P||!z,K=g.useRef(i),Q=g.useRef(n),D=g.useRef(!1),G=g.useRef(C.length),X=g.useRef(i),k=g.useMemo(()=>!1,[]);g.useEffect(()=>{var w;k&&(C.length!==G.current||i!==X.current)&&(console.log("[TronWalletLogin] ç‹€æ…‹æ›´æ–°:",{availableWalletsCount:C.length,connected:i,currentWallet:(w=j==null?void 0:j.adapter)==null?void 0:w.name}),G.current=C.length,X.current=i)},[C.length,i,(ee=j==null?void 0:j.adapter)==null?void 0:ee.name,k]);const Ce=async()=>{a("");try{const v=`login_${Date.now()}`,E=encodeURIComponent(window.location.origin+F.CALLBACK_PATH),N=`${F.TRONWALLET_SCHEME}login?callback=${E}&requestId=${v}`;if(P&&!await p(F.TRONWALLET_SCHEME)){window.confirm(t("errors.appNotInstalled"))&&window.open(F.TRONWALLET_UNIVERSAL_LINK,"_blank");return}await T(N)||a(t("errors.cannotOpenApp"))}catch(w){k&&console.error("APP ç™»å…¥éŒ¯èª¤:",w),a(t("errors.loginFailed"))}};g.useEffect(()=>{const w=new URLSearchParams(window.location.search),v=w.get("address"),E=w.get("requestId");v&&E&&(window.history.replaceState({},document.title,window.location.pathname),k&&console.log("æ”¶åˆ° Deep Link å›èª¿:",{address:v,requestId:E}))},[k]);const Z=g.useRef(!1),S=g.useRef(!1);g.useEffect(()=>{var E;const w=Z.current,v=f||!1;if(w&&!v&&(S.current=!0),v&&!w&&(S.current=!1),Z.current=v,S.current&&o&&!i&&!y&&((E=o==null?void 0:o.adapter)==null?void 0:E.name)){S.current=!1;const L=setTimeout(()=>{o&&!i&&!y&&s().catch(O=>{a(t("errors.connectionFailed",{error:O.message||O.toString()}))})},200);return()=>clearTimeout(L)}i&&S.current&&(S.current=!1)},[f,o,i,y,s,a,t]),g.useEffect(()=>{var N;const w=K.current,v=Q.current;(i!==w||n!==v)&&(k&&console.log("[TronWalletLogin] é€£æ¥ç‹€æ…‹è®ŠåŒ–:",{wasConnected:w,connected:i,address:n,wallet:(N=o==null?void 0:o.adapter)==null?void 0:N.name}),i&&n?(a(""),c("pending"),M(A.WALLET_CONNECTED,{address:n,timestamp:Date.now()}),d(n).then(()=>{c("success")}).catch(L=>{ae(L)?c("pending"):c("failed")})):!i&&w&&(c(null),M(A.WALLET_DISCONNECTED,{timestamp:Date.now()})),K.current=i,Q.current=n)},[i,n,k,(te=o==null?void 0:o.adapter)==null?void 0:te.name,d]),g.useEffect(()=>{const w=()=>{const L=document.querySelectorAll(".official-wallet-button button");if(L.length===0)return;const ne=document.documentElement.getAttribute("data-theme")==="dark"?"#4b5563":"#e5e7eb";L.forEach(I=>{I instanceof HTMLElement&&(I.style.setProperty("background","transparent","important"),I.style.setProperty("border",`2px solid ${ne}`,"important"),I.style.setProperty("background-image","none","important"))})},v=setTimeout(()=>{requestAnimationFrame(w)},100),E=new MutationObserver(()=>{requestAnimationFrame(w)}),N=document.querySelector(".tronwallet-login");return N&&E.observe(N,{childList:!0,subtree:!0}),()=>{clearTimeout(v),E.disconnect()}},[C.length]),g.useEffect(()=>{const w=Ge(r,f,R);return w&&(w.setModalVisible&&w.setModalVisible(f),w.updateWalletStateMap&&w.updateWalletStateMap(R),f&&requestAnimationFrame(()=>{w.translate()})),()=>{w&&w.disconnect&&w.disconnect()}},[r,f,R]),g.useEffect(()=>(D.current||(oe(),D.current=!0),Ie(v=>{switch(v.type){case A.INIT:D.current||(oe(),D.current=!0);break}})),[]);const V=g.useMemo(()=>document.referrer&&document.referrer!==window.location.href?!0:window.history.length>1,[]),Y=()=>{V&&window.history.back()};return i&&n?e.jsxs(e.Fragment,{children:[V&&e.jsxs("button",{className:"back-button",onClick:Y,title:t("common.back"),children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),e.jsx("span",{children:t("common.back")})]}),e.jsx(re,{}),e.jsx(Ye,{address:n,signingStatus:u}),e.jsx(ie,{})]}):e.jsxs("div",{className:"tronwallet-login",children:[V&&e.jsxs("button",{className:"back-button",onClick:Y,title:t("common.back"),children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),e.jsx("span",{children:t("common.back")})]}),e.jsx(re,{}),e.jsx("div",{className:"login-icon",children:e.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),e.jsx("h2",{className:"login-title",children:t("login.title")}),e.jsx("div",{className:"environment-info",children:e.jsxs("div",{className:"env-badge",children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),e.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),e.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]}),e.jsx("span",{className:"env-platform",children:pe}),$&&$!=="Unknown"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"env-separator",children:"Â·"}),e.jsx("span",{className:"env-browser",children:$})]}),U&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"env-separator",children:"Â·"}),e.jsx("span",{className:"env-pwa-badge",children:"PWA"})]})]})}),e.jsx("p",{className:"login-description",children:C.length>0?t("login.description.detected",{wallets:C.map(w=>w.detectedName).join("ã€")}):t(q||U&&!P?"login.description.pc":"login.description.mobile")}),x&&e.jsxs("div",{className:"error-message",children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),x]}),i&&n&&u==="pending"&&e.jsx("div",{className:"signing-prompt",children:e.jsxs("div",{className:"signing-prompt-content",children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"})}),e.jsxs("div",{className:"signing-prompt-text",children:[e.jsx("p",{className:"signing-prompt-title",children:t("signing.pendingTitle","è«‹å®Œæˆç°½åä»¥å®Œæˆç™»å…¥")}),e.jsx("p",{className:"signing-prompt-desc",children:t("signing.pendingDesc","éŒ¢åŒ…å·²é€£æ¥ï¼Œè«‹åœ¨éŒ¢åŒ…ä¸­ç¢ºèªç°½åè«‹æ±‚")})]}),e.jsx("button",{className:"signing-prompt-btn",onClick:async()=>{c("pending"),a("");try{await d(n),c("success")}catch(w){ae(w)?c("pending"):c("failed")}},children:t("signing.retry","é‡æ–°ç°½å")})]})}),C.length>0&&e.jsx(et,{availableWallets:C,onWalletClick:async w=>{try{a(""),await b(w)}catch(v){a(t("errors.connectionFailed",{error:v.message||v.toString()}))}},connecting:y,connectedWallet:j}),e.jsxs("div",{className:"login-methods",children:[C.length>0&&e.jsx("div",{className:"method-divider",children:e.jsx("span",{children:t("login.or")})}),e.jsx("div",{className:"official-wallet-button","data-button-text":t("login.selectWallet"),style:{"--button-text":`"${t("login.selectWallet")}"`},children:e.jsx("button",{className:"select-wallet-custom-btn",onClick:w=>{w.preventDefault(),w.stopPropagation(),l(!0)},children:t("login.selectWallet")})}),xe&&we&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"method-divider",children:e.jsx("span",{children:t("login.or")})}),e.jsxs("button",{className:"login-method-btn",onClick:Ce,disabled:y,children:[e.jsx("div",{className:"method-icon",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"}),e.jsx("line",{x1:"12",y1:"18",x2:"12.01",y2:"18"})]})}),e.jsxs("div",{className:"method-content",children:[e.jsx("h3",{children:t("login.useMobileApp")}),e.jsx("p",{children:t("login.mobileAppDesc")})]})]})]})]}),e.jsxs("div",{className:"login-tips",children:[e.jsx("p",{children:t("tips.title")}),e.jsx("ul",{children:q?z?t("tips.pcWithExtension",{wallets:C.map(w=>w.detectedName).join("ã€")}).map((w,v)=>e.jsx("li",{children:w},v)):t("tips.pcWithoutExtension").map((w,v)=>e.jsx("li",{children:w},v)):t("tips.mobile").map((w,v)=>e.jsx("li",{children:w},v))})]}),e.jsx(ie,{})]})},it=()=>[new be,new Ee,new Ne,new ke],at=()=>[new Le,new We],lt=()=>[new Se],ct=()=>{const t=H.METADATA;return new Ae({network:H.NETWORK,options:{projectId:H.PROJECT_ID,metadata:t}})},dt=()=>{const t=[...it(),...at(),...lt()],r=ct();return r&&t.push(r),t};function ut(){return e.jsx("div",{className:"app",children:e.jsx("div",{className:"app-container",children:e.jsx(rt,{})})})}function gt(){const t=g.useMemo(()=>dt(),[]),r=n=>{console.error("éŒ¢åŒ…éŒ¯èª¤:",n)};return e.jsx(Ze,{children:e.jsx(qe,{children:e.jsx(ot,{children:e.jsx(Me,{adapters:t,onError:r,autoConnect:!1,children:e.jsx(Re,{children:e.jsx(ut,{})})})})})})}Te.createRoot(document.getElementById("root")).render(e.jsx(ve.StrictMode,{children:e.jsx(gt,{})}));
